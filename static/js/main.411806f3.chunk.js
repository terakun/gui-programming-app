(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(t,e,o){t.exports=o(24)},24:function(t,e,o){"use strict";o.r(e);var n=o(1),s=o(3),a=o(4),i=o(6),r=o(5),l=o(7),c=o(0),h=o.n(c),u=o(10),d=o.n(u),b=o(9),m=o.n(b),p=o(8),g=o.n(p),f=o(2),v=o(14),y=o.n(v),O=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state={is_invalid:!1},o.number=o.props.number,o.setCompFrom=t.funcs.setCompFrom,o.setCompTo=t.funcs.setCompTo,t.funcs.addOpObj(Object(n.a)(Object(n.a)(o))),o.boxstyle={width:100,height:60,left:500,top:200,padding:"0 16px",color:"#000",background:"#fff",position:"absolute",textAlign:"center",borderRadius:4,WebkitUserSelect:"none"},o.topstyle={marginLeft:"auto",borderRadius:4,border:"solid",color:"#f2df6b",background:"#f2df6b",position:"absolute",top:0,left:0,right:0,margin:"auto"},o.bottomstyle={marginLeft:"auto",borderRadius:4,border:"solid",color:"#e174bb",background:"#e174bb",position:"absolute",bottom:0,left:0,right:0,margin:"auto"},o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"disable",value:function(){this.setState({is_invalid:!0})}},{key:"getTopPosition",value:function(){var t=d.a.findDOMNode(this.refs.top).getBoundingClientRect();return[t.x+t.width/2,t.y+t.height/2]}},{key:"getBottomPosition",value:function(){var t=d.a.findDOMNode(this.refs.bottom).getBoundingClientRect();return[t.x+t.width/2,t.y+t.height/2]}},{key:"renderOpComp",value:function(){}},{key:"render",value:function(){var t=this;return void 0!==this.props.x&&(this.boxstyle.left=this.props.x,this.boxstyle.top=this.props.y),this.state.is_invalid?h.a.createElement("div",{style:{display:"none"}}):h.a.createElement(y.a,{bounds:"parent",cancel:"strong",onStart:function(){t.props.funcs.onStartDrag(t)},onStop:function(){t.props.funcs.onStopDrag(t)}},this.renderOpComp())}}]),e}(h.a.Component),w=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state),o.boxstyle.height=50,o.boxstyle.left=20,o.boxstyle.top=10,o.boxstyle.position="absolute",o.bottomstyle=Object(f.a)({},o.bottomstyle,{width:100,height:10}),o.textstyle={textAlign:"center",position:"relative",top:"30%"},o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"getTopPosition",value:function(){return[0,0]}},{key:"render",value:function(){var t=this;return h.a.createElement("strong",{className:"no-cursor"},h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("div",{style:this.textstyle},"\u30b9\u30bf\u30fc\u30c8"),h.a.createElement("div",{ref:"bottom",style:this.bottomstyle,onMouseDown:function(){t.setCompFrom(t)}})))}}]),e}(O),E=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state),o.boxstyle.position="absolute",o.boxstyle.height=50,o.boxstyle.left=1050,o.boxstyle.top=500,o.topstyle=Object(f.a)({},o.topstyle,{width:100,height:10}),o.textstyle={position:"relative",textAlign:"center",top:"30%"},o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"getBottomPosition",value:function(){return[0,0]}},{key:"renderOpComp",value:function(){var t=this;return h.a.createElement("strong",{className:"no-cursor"},h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseUp:function(){t.setCompTo(t)}}),h.a.createElement("div",{style:this.textstyle},"\u30a8\u30f3\u30c9")))}}]),e}(O),j=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state),o.topstyle=Object(f.a)({},o.topstyle,{width:100,height:10,border:"solid"}),o.textstyle={position:"relative",textAlign:"center",top:"30%"},o.bottomstyle=Object(f.a)({},o.bottomstyle,{width:100,height:10,border:"solid"}),o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"renderOpComp",value:function(){var t=this;return h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseUp:function(){t.setCompTo(t)}})),h.a.createElement("div",{style:this.textstyle},"\u30b9\u30c8\u30c3\u30d7"),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"bottom",style:this.bottomstyle,onMouseDown:function(){t.setCompFrom(t)}})))}}]),e}(O),k=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state,{wheel:0,direction:0,power:0}),o.props.funcs.setOpComponentAttribute(o.number,o.getAttribute()),o.boxstyle.width=180,o.topstyle=Object(f.a)({},o.topstyle,{width:70,height:10}),o.textstyle={position:"relative",textAlign:"center",top:20},o.bottomstyle=Object(f.a)({},o.bottomstyle,{width:70,height:10}),o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"getAttribute",value:function(){return{wheel:this.state.wheel,direction:this.state.direction,power:this.state.power}}},{key:"setWheel",value:function(t){this.setState({wheel:t.target.value});var e=this.getAttribute();e.wheel=t.target.value,this.props.funcs.setOpComponentAttribute(this.number,e)}},{key:"setDirection",value:function(t){this.setState({direction:t.target.value});var e=this.getAttribute();e.direction=t.target.value,this.props.funcs.setOpComponentAttribute(this.number,e)}},{key:"setPower",value:function(t){this.setState({power:t.target.value});var e=this.getAttribute();e.power=t.target.value,this.props.funcs.setOpComponentAttribute(this.number,e)}},{key:"renderOpComp",value:function(){var t=this;return this.props.running?this.boxstyle.background="#00f":this.boxstyle.background="#fff",h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseUp:function(){t.setCompTo(t)}})),h.a.createElement("div",{style:this.textstyle},h.a.createElement("select",{name:"wheel",defaultValue:0,onChange:this.setWheel.bind(this)},h.a.createElement("option",{value:0},"\u5de6"),h.a.createElement("option",{value:1},"\u53f3")),"\u30bf\u30a4\u30e4\u3092",h.a.createElement("select",{name:"direction",defaultValue:0,onChange:this.setDirection.bind(this)},h.a.createElement("option",{value:0},"\u524d"),h.a.createElement("option",{value:1},"\u5f8c")),"\u306b",h.a.createElement("select",{name:"power",defaultValue:0,onChange:this.setPower.bind(this)},h.a.createElement("option",{value:3},"\u5f37"),h.a.createElement("option",{value:2},"\u4e2d"),h.a.createElement("option",{value:1},"\u5f31"),h.a.createElement("option",{value:0},"\u6b62"))),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"bottom",style:this.bottomstyle,onMouseDown:function(){t.setCompFrom(t)}})))}}]),e}(O),C=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state,{time:0}),o.topstyle=Object(f.a)({},o.topstyle,{width:70,height:10}),o.textstyle={position:"relative",textAlign:"center",top:"30%"},o.bottomstyle=Object(f.a)({},o.bottomstyle,{width:70,height:10}),o.boxstyle.height=60,o.props.funcs.setOpComponentAttribute(o.number,{time:o.state.time}),o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"setTime",value:function(t){this.setState({time:t.target.value}),console.log(t.target.value),this.props.funcs.setOpComponentAttribute(this.number,{time:t.target.value})}},{key:"renderOpComp",value:function(){var t=this;return this.props.running?this.boxstyle.background="#00f":this.boxstyle.background="#fff",h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseDown:function(){t.setCompFrom(t)},onMouseUp:function(){t.setCompTo(t)}})),h.a.createElement("div",{style:this.textstyle},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("input",{style:{width:40},onChange:this.setTime.bind(this)})),"ms \u5f85\u3064"),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"bottom",style:this.bottomstyle,onMouseDown:function(){t.setCompFrom(t)},onMouseUp:function(){t.setCompTo(t)}})))}}]),e}(O),x=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state,{dist:0}),o.selected_above=!1,o.abovedstnode=null,o.belowdstnode=null,o.props.funcs.setOpComponentAttribute(o.number,{dist:o.state.dist}),o.setBranch=o.setBranch.bind(Object(n.a)(Object(n.a)(o))),o.boxstyle.width=160,o.boxstyle.height=65,o.topstyle=Object(f.a)({},o.topstyle,{width:70,height:10}),o.textstyle={position:"relative",textAlign:"center",top:"30%"},o.bottomleftstyle=Object(f.a)({},o.bottomstyle,{width:60,height:20,border:"none",color:"#fff",left:0,right:"auto",borderRadius:2}),o.bottomrightstyle=Object(f.a)({},o.bottomstyle,{width:60,height:20,border:"none",color:"#fff",left:"auto",right:0,borderRadius:2}),o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"setDist",value:function(t){this.setState({dist:t.target.value}),this.props.funcs.setOpComponentAttribute(this.number,{dist:t.target.value})}},{key:"setBranch",value:function(t){this.selected_above?(this.abovedstnode=t,console.log("above:"+t)):(this.belowdstnode=t,console.log("below:"+t)),this.selected_above=!1}},{key:"getBottomBelowPosition",value:function(){var t=this.refs.below.getBoundingClientRect();return[t.x+t.width/2,t.y+t.height/2]}},{key:"getBottomAbovePosition",value:function(){var t=this.refs.above.getBoundingClientRect();return[t.x+t.width/2,t.y+t.height/2]}},{key:"renderOpComp",value:function(){var t=this;return this.props.running?this.boxstyle.background="#0f0":this.boxstyle.background="#fff",h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseUp:function(){t.setCompTo(t)}})),h.a.createElement("div",{style:this.textstyle},"\u8ddd\u96e2\u30bb\u30f3\u30b5\u30fc\u304c",h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("input",{style:{width:40},value:this.state.dist,onChange:this.setDist.bind(this)})),"cm"),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"above",style:this.bottomleftstyle,onMouseDown:function(){t.selected_above=!0,t.setCompFrom(t)}},"\u4ee5\u4e0a")),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"below",style:this.bottomrightstyle,onMouseDown:function(){t.selected_above=!1,t.setCompFrom(t)}},"\u4ee5\u4e0b")))}}]),e}(O),S=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state,{isright:0}),o.selected_above=!1,o.abovedstnode=null,o.belowdstnode=null,o.props.funcs.setOpComponentAttribute(o.number,{dist:o.state.dist}),o.setBranch=o.setBranch.bind(Object(n.a)(Object(n.a)(o))),o.boxstyle.width=160,o.boxstyle.height=65,o.topstyle=Object(f.a)({},o.topstyle,{width:160,height:10}),o.textstyle={position:"relative",textAlign:"center",top:"30%"},o.bottomleftstyle=Object(f.a)({},o.bottomstyle,{width:60,height:20,border:"none",color:"#fff",left:0,right:"auto",borderRadius:2}),o.bottomrightstyle=Object(f.a)({},o.bottomstyle,{width:60,height:20,border:"none",color:"#fff",left:"auto",right:0,borderRadius:2}),o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"setIsright",value:function(t){this.setState({isright:t.target.value}),this.props.funcs.setOpComponentAttribute(this.number,{isright:t.target.value})}},{key:"setBranch",value:function(t){this.selected_above?(this.abovedstnode=t,console.log("above:"+t)):(this.belowdstnode=t,console.log("below:"+t)),this.selected_above=!1}},{key:"getBottomBelowPosition",value:function(){var t=this.refs.below.getBoundingClientRect();return[t.x+t.width/2,t.y+t.height/2]}},{key:"getBottomAbovePosition",value:function(){var t=this.refs.above.getBoundingClientRect();return[t.x+t.width/2,t.y+t.height/2]}},{key:"renderOpComp",value:function(){var t=this;return this.props.running?this.boxstyle.background="#0f0":this.boxstyle.background="#fff",h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseUp:function(){t.setCompTo(t)}})),h.a.createElement("div",{style:this.textstyle},h.a.createElement("select",{name:"isright",defaultValue:!0,onChange:this.setIsright.bind(this)},h.a.createElement("option",{value:!1},"\u5de6"),h.a.createElement("option",{value:!0},"\u53f3")),"\u306e\u30bb\u30f3\u30b5\u30fc\u304c"),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"above",style:this.bottomleftstyle,onMouseDown:function(){t.selected_above=!0,t.setCompFrom(t)}},"\u6697\u3044")),h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"below",style:this.bottomrightstyle,onMouseDown:function(){t.selected_above=!1,t.setCompFrom(t)}},"\u660e\u308b\u3044")))}}]),e}(O),M=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state=Object(f.a)({},o.state),o.boxstyle=Object(f.a)({},o.boxstyle,{width:20,height:60,padding:0}),o.topstyle={marginLeft:"auto",width:20,height:20,borderRadius:"50%",background:"#f2df6b",border:"none",backgroundColor:"#f2df6b",position:"absolute",bottom:0,left:0,right:0,margin:"auto"},o.bottomstyle={marginLeft:"auto",width:20,height:20,borderRadius:"50%",background:"#e174bb",border:"none",backgroundColor:"#e174bb",position:"absolute",top:0,left:0,right:0,margin:"auto"},o.props.funcs.setOpComponentAttribute(o.number,null),o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"renderOpComp",value:function(){var t=this;return this.props.running?this.boxstyle.background="#00f":this.boxstyle.background="#fff",h.a.createElement(g.a,{style:this.boxstyle,className:"box"},h.a.createElement("strong",{className:"no-cursor"},h.a.createElement("div",{ref:"bottom",style:this.bottomstyle,onMouseDown:function(){t.setCompFrom(t)}}),h.a.createElement("div",{ref:"top",style:this.topstyle,onMouseUp:function(){t.setCompTo(t)}})))}}]),e}(O),D=function(t){function e(){return Object(s.a)(this,e),Object(i.a)(this,Object(r.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(a.a)(e,[{key:"render",value:function(){var t=this.props,e=t.x1,o=t.x2,n=t.y1,s=t.y2,a=t.thickness,i=(t.color,Math.sqrt((o-e)*(o-e)+(s-n)*(s-n))),r=(e+o)/2-i/2,l=(n+s)/2-a/2,c=Math.atan2(n-s,e-o)*(180/Math.PI),u={padding:0,margin:0,backgroundColor:"#000000",lineHeight:1,position:"absolute",left:r,top:l,width:i,height:3,MozTransform:"rotate(".concat(c,"deg)"),WebkitTransform:"rotate(".concat(c,"deg)"),OTransform:"rotate(".concat(c,"deg)"),msTransform:"rotate(".concat(c,"deg)"),transform:"rotate(".concat(c,"deg)")};return h.a.createElement(g.a,{style:u})}}]),e}(h.a.Component),B=o(15),P=function(){function t(){Object(s.a)(this,t),this.edges=[[],[]],this.start_node=0,this.end_node=1,this.nodes=["Start","End"],this.attributes=[{},{}],this.nodes_num=this.edges.length}return Object(a.a)(t,[{key:"addComponent",value:function(t){return this.edges.push([]),this.nodes.push(t),this.attributes.push({}),this.nodes_num++,this}},{key:"deleteEdge",value:function(t,e){var o=this.edges[t].findIndex(function(t){return t===e});return this.edges[t].splice(o,1),this}},{key:"deleteEdges",value:function(t){var e=!0,o=!1,n=void 0;try{for(var s,a=t[Symbol.iterator]();!(e=(s=a.next()).done);e=!0){var i=s.value,r=Object(B.a)(i,2),l=r[0],c=r[1];this.deleteEdge(l,c)}}catch(h){o=!0,n=h}finally{try{e||null==a.return||a.return()}finally{if(o)throw n}}return this}},{key:"setAttribute",value:function(t,e){return this.attributes[t]=e,this}},{key:"checkConnectStartToEnd",value:function(){for(var t=[this.start_node],e=new Array(this.nodes_num).fill(!1);t.length>0;){var o=t.pop();if(e[o]=!0,console.log(this.nodes[o]),o!==this.end_node&&(("BranchDistSensor"===this.nodes[o]||"LineSensor"===this.nodes[o])&&this.edges[o].length<2||"BranchDistSensor"!==this.nodes[o]&&"LineSensor"!==this.nodes[o]&&0===this.edges[o].length))return!1;var n=!0,s=!1,a=void 0;try{for(var i,r=this.edges[o][Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;e[l]||t.push(l)}}catch(c){s=!0,a=c}finally{try{n||null==r.return||r.return()}finally{if(s)throw a}}}return!0}},{key:"addEdge",value:function(t,e){return console.log(t),console.log(e),this.edges[t].push(e),this}}]),t}(),F=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).boxstyle={width:100,height:60,left:40,top:470,color:"#fff",background:"#333",position:"absolute",textAlign:"center",borderRadius:4,WebkitUserSelect:"none"},o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"render",value:function(){return h.a.createElement(g.a,{style:this.boxstyle},"\u30b4\u30df\u7bb1")}}]),e}(h.a.Component),A=function(t){function e(t){var o;return Object(s.a)(this,e),(o=Object(i.a)(this,Object(r.a)(e).call(this,t))).state={mouseX:0,mouseY:0,clickFrom:-1,clickTo:0,isMouseDown:!1,graph:new P,toppositions:[[0,0],[0,0]],bottompositions:[[0,0],[0,0]],sensordata:{dist:0,left:0,right:0},dragcomp:0,currentnode:0,timercount:0,interval:null,sendinterval:null,carstate:{left:{forward:!0,power:0},right:{forward:!0,power:0}},pwm:{left:[0,150,200,255],right:[0,150,200,255]},linesensor_threshold:512,swaplinesensor:!1,isrunning:!1},o.dragComp=-1,o.opobj=[],o.connection=new WebSocket("ws:127.0.0.1:8000"),o.connection.onopen=o.onOpen.bind(Object(n.a)(Object(n.a)(o))),o.connection.onmessage=o.onMessage.bind(Object(n.a)(Object(n.a)(o))),o.runProgram=o.runProgram.bind(Object(n.a)(Object(n.a)(o))),o.stepProgram=o.stepProgram.bind(Object(n.a)(Object(n.a)(o))),o.stopProgram=o.stopProgram.bind(Object(n.a)(Object(n.a)(o))),o.sendOperation=o.sendOperation.bind(Object(n.a)(Object(n.a)(o))),o._onMouseMove=o._onMouseMove.bind(Object(n.a)(Object(n.a)(o))),o.funcs={setCompFrom:o.setCompFrom.bind(Object(n.a)(Object(n.a)(o))),setCompTo:o.setCompTo.bind(Object(n.a)(Object(n.a)(o))),setOpComponentAttribute:o.setOpComponentAttribute.bind(Object(n.a)(Object(n.a)(o))),addOpObj:o.addOpObj.bind(Object(n.a)(Object(n.a)(o))),onStartDrag:o.onStartDrag.bind(Object(n.a)(Object(n.a)(o))),onStopDrag:o.onStopDrag.bind(Object(n.a)(Object(n.a)(o)))},o}return Object(l.a)(e,t),Object(a.a)(e,[{key:"addOpObj",value:function(t){this.opobj.push(t)}},{key:"onOpen",value:function(t){console.log("Connect successful!"),this.sendinterval=setInterval(this.sendOperation,100)}},{key:"onMessage",value:function(t){var e=t.data.split(",").map(function(t){return parseInt(t,10)});this.state.swaplinesensor?this.setState({sensordata:{dist:e[0],left:e[2],right:e[1]}}):this.setState({sensordata:{dist:e[0],left:e[1],right:e[2]}})}},{key:"addComponent",value:function(t){var e=Object.assign([],this.state.toppositions),o=Object.assign([],this.state.bottompositions);e.push([0,0]),"BranchDistSensor"!==t&&"LineSensor"!==t?o.push([0,0]):o.push([[0,0],[0,0]]),this.setState({toppositions:e,bottompositions:o,graph:this.state.graph.addComponent(t)})}},{key:"_onMouseMove",value:function(t){-1!==this.dragComp&&void 0!==this.dragComp&&this.setOpCompPosition(this.dragComp),this.setState({mouseX:t.clientX,mouseY:t.clientY})}},{key:"_onMouseClick",value:function(t){this.setState({isMouseDown:!0})}},{key:"setOpCompPosition",value:function(t){var e=this.state.toppositions,o=this.state.bottompositions;e[t]=this.opobj[t].getTopPosition(),this.isBranchComp(t)?(o[t][0]=this.opobj[t].getBottomAbovePosition(),o[t][1]=this.opobj[t].getBottomBelowPosition()):o[t]=this.opobj[t].getBottomPosition(),this.setState({toppositions:e,bottompositions:o})}},{key:"setCompFrom",value:function(t){console.log("From:"+t.number),this.isBranchComp(t.number)?null!==this.opobj[t.number].abovedstnode&&this.opobj[t.number].selected_above?(this.setState({graph:this.state.graph.deleteEdge(t.number,this.opobj[t.number].abovedstnode)}),this.opobj[t.number].abovedstnode=null):null===this.opobj[t.number].belowdstnode||this.opobj[t.number].selected_above||(this.setState({graph:this.state.graph.deleteEdge(t.number,this.opobj[t.number].belowdstnode)}),this.opobj[t.number].belowdstnode=null):1===this.state.graph.edges[t.number].length&&this.setState({graph:this.state.graph.deleteEdge(t.number,this.state.graph.edges[t.number][0])}),this.setOpCompPosition(t.number),this.setState({clickFrom:t.number,isMouseDown:!0})}},{key:"setCompTo",value:function(t){console.log("From:"+this.state.clickFrom),console.log("To:"+t.number),-1===this.state.clickFrom||t.number===this.state.clickFrom?this.setState({isMouseDown:!1}):(!this.isBranchComp(this.state.clickFrom)&&0===this.state.graph.edges[this.state.clickFrom].length||this.isBranchComp(this.state.clickFrom)&&this.state.graph.edges[this.state.clickFrom].length<=1)&&(this.isBranchComp(this.state.clickFrom)&&this.opobj[this.state.clickFrom].setBranch(t.number),this.setOpCompPosition(t.number),this.setState({clickTo:t.number,isMouseDown:!1,graph:this.state.graph.addEdge(this.state.clickFrom,t.number)}))}},{key:"runProgram",value:function(){return this.state.graph.checkConnectStartToEnd()?(this.interval=setInterval(this.stepProgram,10),console.log("connected"),this.setState({isrunning:!0}),!0):(console.log("disconnected"),alert("\u7e4b\u304c\u3063\u3066\u3044\u306a\u3044\u30d1\u30fc\u30c4\u304c\u3042\u308b\u3088"),!1)}},{key:"sendOperation",value:function(){var t=this.state.carstate.left,e=this.state.carstate.right;if(0===t.power&&0===e.power)this.connection.send("s"),console.log("s");else{var o=this.state.pwm.left[t.power];t.forward||(o=-o);var n=this.state.pwm.right[e.power];e.forward||(n=-n),this.connection.send("r"+(-n).toString()),this.connection.send("l"+(-o).toString())}}},{key:"stepProgram",value:function(){console.log("step");var t=this.state.currentnode,e=this.state.graph.edges[t],o=null,n=this.state.graph.attributes[t],s=this.state.carstate;switch(this.state.graph.nodes[t]){case"Start":o=e[0];break;case"End":o=0,s.left.power=0,s.right.power=0,console.log("Program Terminated"),clearInterval(this.interval),this.setState({isrunning:!1});break;case"Wheel":var a=parseInt(n.wheel,10),i=parseInt(n.direction,10),r=parseInt(n.power,10),l={forward:0===i,power:r};0===a?s.left=l:s.right=l,o=e[0],console.log("Wheel:"+r);break;case"Waitmsecs":10*this.state.timercount>n.time?(o=e[0],this.setState({timercount:0})):(o=t,this.setState({timercount:this.state.timercount+1}));break;case"BranchDistSensor":o=parseInt(n.dist,10)>this.state.sensordata.dist?this.opobj[t].belowdstnode:this.opobj[t].abovedstnode;break;case"LineSensor":var c=n.isright;console.log(c),o=c?this.state.sensordata.right>this.state.linesensor_threshold?this.opobj[t].belowdstnode:this.opobj[t].abovedstnode:this.state.sensordata.left>this.state.linesensor_threshold?this.opobj[t].belowdstnode:this.opobj[t].abovedstnode;break;case"Readability":o=e[0],console.log("fuga");break;case"Stop":s.left.power=0,s.right.power=0,o=e[0]}this.setState({currentnode:o,carstate:s})}},{key:"onStartDrag",value:function(t){this.dragComp=t.number,console.log("start drag:"+t.number)}},{key:"isBranchComp",value:function(t){return"BranchDistSensor"===this.state.graph.nodes[t]||"LineSensor"===this.state.graph.nodes[t]}},{key:"onStopDrag",value:function(t){var e=d.a.findDOMNode(t).getBoundingClientRect(),o=d.a.findDOMNode(this.refs.trashbox).getBoundingClientRect(),n=e.x+e.width/2,s=e.y+e.height/2,a=[],i=this.state.graph;if(o.x<=n&&n<o.x+o.width&&o.y<=s&&s<o.y+o.height){var r=0,l=!0,c=!1,h=void 0;try{for(var u,b=this.state.graph.edges[Symbol.iterator]();!(l=(u=b.next()).done);l=!0){var m=u.value,p=!0,g=!1,f=void 0;try{for(var v,y=m[Symbol.iterator]();!(p=(v=y.next()).done);p=!0){var O=v.value;O===t.number?(this.isBranchComp(r)&&(this.opobj[r].abovedstnode===O?this.opobj[r].abovedstnode=null:this.opobj[r].belowdstnode===O&&(this.opobj[r].belowdstnode=null)),a.push([r,O])):r===t.number&&a.push([r,O])}}catch(w){g=!0,f=w}finally{try{p||null==y.return||y.return()}finally{if(g)throw f}}r++}}catch(w){c=!0,h=w}finally{try{l||null==b.return||b.return()}finally{if(c)throw h}}this.opobj[t.number].disable(),this.setState({graph:i.deleteEdges(a)})}this.dragComp=-1}},{key:"stopProgram",value:function(){clearInterval(this.interval),this.setState({timercount:0,carstate:{left:{forward:!0,power:0},right:{forward:!0,power:0}},currentnode:0,isrunning:!1})}},{key:"setOpComponentAttribute",value:function(t,e){var o=this.state.graph.setAttribute(t,e);this.setState({graph:o})}},{key:"renderOpComponents",value:function(){var t=this;return this.state.graph.nodes.map(function(e,o){var n=t.state.currentnode===o;switch(e){case"Start":return h.a.createElement(w,{key:o,number:o,running:n,funcs:t.funcs});case"End":return h.a.createElement(E,{key:o,number:o,running:n,funcs:t.funcs});case"Wheel":return h.a.createElement(k,{key:o,number:o,running:n,funcs:t.funcs});case"Waitmsecs":return h.a.createElement(C,{key:o,number:o,running:n,funcs:t.funcs});case"BranchDistSensor":return h.a.createElement(x,{key:o,number:o,running:n,funcs:t.funcs});case"LineSensor":return h.a.createElement(S,{key:o,number:o,running:n,funcs:t.funcs});case"Stop":return h.a.createElement(j,{key:o,number:o,running:n,funcs:t.funcs});case"Readability":return h.a.createElement(M,{key:o,number:o,running:n,funcs:t.funcs});default:return h.a.createElement("div",null,"Error")}})}},{key:"renderEdges",value:function(){var t=this;return this.state.graph.edges.map(function(e,o){return e.map(function(e,n){var s=[0,0];s="BranchDistSensor"!==t.state.graph.nodes[o]&&"LineSensor"!==t.state.graph.nodes[o]?t.state.bottompositions[o]:e===t.opobj[o].abovedstnode?t.state.bottompositions[o][0]:t.state.bottompositions[o][1];var a;return a=t.state.toppositions[e],h.a.createElement(D,{key:t.nodes_num*o+n,x1:s[0],y1:s[1],id1:o,x2:a[0],y2:a[1],id2:e,thickness:1,color:"black"})})})}},{key:"setPWMLeftValue",value:function(t,e){var o=this.state.pwm.left.slice();console.log(t),o[t]=e.target.value,this.setState({pwm:{left:o,right:this.state.pwm.right}})}},{key:"setPWMRightValue",value:function(t,e){var o=this.state.pwm.right.slice();o[t]=e.target.value,this.setState({pwm:{left:this.state.pwm.left,right:o}})}},{key:"swapLineSensor",value:function(t){console.log(t.checked),this.setState({swaplinesensor:t.checked})}},{key:"renderDebugWindow",value:function(){var t=this,e=this.state,o=e.mouseX,n=e.mouseY,s=e.currentnode,a=e.timercount,i=this.state.isMouseDown.toString(),r=this.state.sensordata.dist,l=this.state.sensordata.left,c=this.state.sensordata.right,u=this.state.pwm.left[this.state.carstate.left.power],d=this.state.pwm.right[this.state.carstate.right.power],b=this.opobj;return h.a.createElement("div",null,"Debug Information",h.a.createElement("div",null,"\u30bf\u30a4\u30e4\u53f3",h.a.createElement("div",null,"\u5f31",h.a.createElement("input",{value:this.state.pwm.right[1],onChange:this.setPWMRightValue.bind(this,1)})),h.a.createElement("div",null,"\u4e2d",h.a.createElement("input",{value:this.state.pwm.right[2],onChange:this.setPWMRightValue.bind(this,2)})),h.a.createElement("div",null,"\u5f37",h.a.createElement("input",{value:this.state.pwm.right[3],onChange:this.setPWMRightValue.bind(this,3)}))),h.a.createElement("div",null,"\u30bf\u30a4\u30e4\u5de6",h.a.createElement("div",null,"\u5f31",h.a.createElement("input",{value:this.state.pwm.left[1],onChange:this.setPWMLeftValue.bind(this,1)})),h.a.createElement("div",null,"\u4e2d",h.a.createElement("input",{value:this.state.pwm.left[2],onChange:this.setPWMLeftValue.bind(this,2)})),h.a.createElement("div",null,"\u5f37",h.a.createElement("input",{value:this.state.pwm.left[3],onChange:this.setPWMLeftValue.bind(this,3)}))),h.a.createElement("div",null,"\u5149\u30bb\u30f3\u30b5",h.a.createElement("div",null,"\u3057\u304d\u3044\u5024",h.a.createElement("input",{value:this.state.linesensor_threshold,onChange:function(e){t.setState({linesensor_threshold:e.target.value})}})),h.a.createElement("div",null,"\u5de6\u53f3\u5165\u308c\u66ff\u3048",h.a.createElement("input",{type:"checkbox",checked:this.state.swaplinesensor,onChange:this.swapLineSensor.bind(this)}))),h.a.createElement("div",null,o," ",n," ",i),h.a.createElement("div",null,"currentnode: ",s),h.a.createElement("div",null,"distsensordata: ",r),h.a.createElement("div",null,"leftsensordata: ",l),h.a.createElement("div",null,"rightsensordata: ",c),h.a.createElement("div",null,"pwmleft:",this.state.pwm.left),h.a.createElement("div",null,"pwmright:",this.state.pwm.right),h.a.createElement("div",null,"threshold:",this.state.linesensor_threshold),h.a.createElement("div",null,"swapLineSensor:",this.state.swaplinesensor),h.a.createElement("div",null,"leftspeed: ",u),h.a.createElement("div",null,"rightspeed: ",d),h.a.createElement("div",null,"timercount: ",a),h.a.createElement("div",null,"opobj: ",b.toString()),h.a.createElement("div",null,"toppositions: ",this.state.toppositions.toString()),h.a.createElement("div",null,"bottompositions: ",this.state.bottompositions.toString()),h.a.createElement("div",{className:"NodesInfo"},"Nodes Information",h.a.createElement("ol",{start:"0"},this.state.graph.nodes.map(function(e,o){return h.a.createElement("li",{key:o},e,":",JSON.stringify(t.state.graph.attributes[o],null,"\t"))}))),h.a.createElement("div",{className:"EdgesInfo"},"Edges Information",h.a.createElement("ol",{start:"0"},this.state.graph.edges.map(function(t,e){return h.a.createElement("li",{key:e},t)}))))}},{key:"render",value:function(){var t=this,e=[0,0];-1!==this.state.clickFrom&&void 0!==this.state.clickFrom&&(e="BranchDistSensor"!==this.state.graph.nodes[this.state.clickFrom]&&"LineSensor"!==this.state.graph.nodes[this.state.clickFrom]?this.state.bottompositions[this.state.clickFrom]:this.opobj[this.state.clickFrom].selected_above?this.state.bottompositions[this.state.clickFrom][0]:this.state.bottompositions[this.state.clickFrom][1]);var o=this.state,n=o.mouseX,s=o.mouseY;return h.a.createElement("div",null,h.a.createElement(g.a,{onMouseMove:this._onMouseMove.bind(this),onMouseUp:function(){t.setState({isMouseDown:!1})},style:{top:10,width:"95vw",height:"85vh",position:"static",background:"#f0f0f0",border:"solid",padding:"10 16px",margin:"0 auto"}},h.a.createElement("div",{style:{textAlign:"right"}},h.a.createElement(m.a,{color:"primary",onClick:function(){t.addComponent("Wheel")}},"\u8eca\u3092\u52d5\u304b\u3059"),h.a.createElement(m.a,{color:"primary",onClick:function(){t.addComponent("Waitmsecs")}},"\u5f85\u3064"),h.a.createElement(m.a,{color:"primary",onClick:function(){t.addComponent("BranchDistSensor")}},"\u8ddd\u96e2\u3092\u6e2c\u308b"),h.a.createElement(m.a,{color:"primary",onClick:function(){t.addComponent("LineSensor")}},"\u660e\u308b\u3055\u3092\u6e2c\u308b"),h.a.createElement(m.a,{color:"primary",onClick:function(){t.addComponent("Stop")}},"\u8eca\u3092\u6b62\u3081\u308b"),h.a.createElement(m.a,{color:"primary",onClick:function(){t.addComponent("Readability")}},"\u898b\u3084\u3059\u304f\u3059\u308b")),this.renderEdges(),function(){if(t.state.isMouseDown)return h.a.createElement(D,{x1:e[0],y1:e[1],id1:-1,x2:n,y2:s,id2:-1,thickness:1,color:"black"})}(),this.renderOpComponents(),h.a.createElement(F,{ref:"trashbox"})),h.a.createElement("div",{style:{textAlign:"right"}},h.a.createElement(m.a,{color:"primary",variant:"fab",onClick:this.runProgram.bind(this),disabled:this.state.isrunning},"\u5b9f\u884c"),h.a.createElement(m.a,{color:"danger",variant:"fab",onClick:this.stopProgram.bind(this)},"\u3084\u3081\u308b"),h.a.createElement(m.a,{color:"accent",variant:"fab",onClick:function(){t.connection=new WebSocket("ws:127.0.0.1:8000")}},"\u518d\u63a5\u7d9a")),h.a.createElement("div",null,this.renderDebugWindow()))}}]),e}(h.a.Component);d.a.render(h.a.createElement(A,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.411806f3.chunk.js.map